"use strict";(self.webpackChunkciara_donnen=self.webpackChunkciara_donnen||[]).push([[875],{4627:function(e,t,n){n.d(t,{ki:function(){return f},ep:function(){return Y},UQ:function(){return m},Zv:function(){return h}});var r=n(4569),a=n.n(r)().create(),o={validateStatus:function(e){if(401!==e)return!0}};function l(e){return e}function i(e){return e}a.defaults.headers.post["Content-Type"]="application/json",a.defaults.headers.post.Accept="application/json";var c=function(e){return a.get("https://market-area.herokuapp.com/",o).then(i,l)},s=function(e){return a.post("https://market-area.herokuapp.com/add",e,o).then(i,l)},d=function(e,t){return a.put("https://market-area.herokuapp.com/".concat(t),e,o).then(i,l)},u=function(e){return a.delete("https://market-area.herokuapp.com/".concat(e),o).then(i,l)};function m(e){return function(t){t({type:"LOADING",payload:!0}),c().then((function(n){t({type:"GET_DATA",payload:n.data}),e(n.data)})).catch((function(e){}))}}function f(e,t){return function(n){n({type:"LOADING",payload:!0}),s(e).then((function(e){n({type:"ADD_DATA",payload:e.data}),t(e.data)})).catch((function(e){}))}}function h(e,t,n){return function(r){r({type:"LOADING",payload:!0}),d(e,t).then((function(e){r({type:"UPDATE_DATA",payload:e.data}),n(e.data)})).catch((function(e){}))}}function Y(e,t){return function(n){n({type:"LOADING",payload:!0}),u(e).then((function(e){n({type:"DELETE_DATA",payload:e.data}),t(e.data)})).catch((function(e){}))}}},6875:function(e,t,n){n.r(t);var r=n(2982),a=n(4942),o=n(885),l=n(1413),i=n(8983),c=n(2791),s=n(7689),d=n(2426),u=n.n(d),m=(n(5125),n(1052),n(6030)),f=n(4627),h=(n(6912),n(9085)),Y=(n(5462),n(4045)),p=n(5062),D=n(184),y={optionArr:[],company:"",party:"",broker:""},x=function(e,t){return(0,l.Z)((0,l.Z)({},e),t)};t.default=function(){var e=(0,c.useReducer)(x,y),t=(0,o.Z)(e,2),n=t[0],d=t[1],A=n.company,g=n.optionArr,v=n.party,M=n.broker,j=(0,s.s0)(),N=(0,m.I0)(),b=(0,c.useState)([]),k=(0,o.Z)(b,2),T=k[0],C=k[1];JSON.parse(localStorage.getItem("record"));(0,c.useEffect)((function(){(0,f.UQ)((function(e){C(e.data),d({optionArr:e.data})}))(N)}),[]);var w=function(e){var t=e.target,r=t.name,o=t.value;if("company"===r){var i;i=g.filter((function(e){return e.cname==o})),d((0,l.Z)((0,l.Z)({},n),{},(0,a.Z)({},r,o))),C(i)}else if("party"===r){var c;c=g.filter((function(e){return e.pname==o})),d((0,l.Z)((0,l.Z)({},n),{},(0,a.Z)({},r,o))),C(c)}else{var s;s=g.filter((function(e){return e.bname==o})),d((0,l.Z)((0,l.Z)({},n),{},(0,a.Z)({},r,o))),C(s)}},B=function(e){var t=new ArrayBuffer(e.length);console.log(t);var n=new Uint8Array(t);console.log(n);for(var r=0;r!==e.length;++r)console.log(e.charCodeAt(r)),n[r]=e.charCodeAt(r);return t},R=function(){var e=[{A:T[0].cname},{}],t=[{A:"Bill Date",B:"Bill No",C:"Bill Amount",D:"Received Date",E:"Total Days",F:"Net Days",G:"Interest Days",h:"interest Amount"}];T.forEach((function(e){var n=e;t.push({A:u()(n.orderDate).format("DD/MM/YYYY"),B:n.billNo,C:n.billAmount,D:u()(n.receivedDate).format("DD/MM/YYYY"),E:u()(u()(n.receivedDate).format("DD.MM.YYYY"),"DD.MM.YYYY").diff(u()(u()(n.orderDate).format("DD.MM.YYYY"),"DD.MM.YYYY"),"days"),F:n.netDays,G:u()(u()(n.receivedDate).format("DD.MM.YYYY"),"DD.MM.YYYY").diff(u()(u()(n.orderDate).format("DD.MM.YYYY"),"DD.MM.YYYY"),"days")-n.netDays,h:(.015*n.billAmount/30*(u()(u()(n.receivedDate).format("DD.MM.YYYY"),"DD.MM.YYYY").diff(u()(u()(n.orderDate).format("DD.MM.YYYY"),"DD.MM.YYYY"),"days")-n.netDays)).toFixed(2)})})),t=[{A:T[0].pname}].concat([{A:T[0].address}]).concat(t).concat([{A:"Total =",C:T.reduce((function(e,t){return e+Number(t.billAmount)}),0)}]);var n=[].concat(e,(0,r.Z)(t)),a=Y.P6.book_new(),o=Y.P6.json_to_sheet(n,{skipHeader:!0});Y.P6.book_append_sheet(a,o,"report");var l=function(e){var t=Y.cW(e,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([B(t)],{type:"application/octet-stream"})}(a),i=[];n.forEach((function(e,t){return"Bill Date"===e.A?i.push(t):null}));T.length;var c={titleRange:"A1:H2",partyName:"A3:D3",brokerName:"E3:H3",address:"A4:H4",total:"A".concat(n.length,":H").concat(n.length),totalInt:"H".concat(n.length),tbodyRange:"A5:H".concat(n.length),theadRange:(null===i||void 0===i?void 0:i.length)>=1?"A".concat(i[0]+1,":H").concat(i[0]+1):null};return I(l,c)},I=function(e,t){var n=T.reduce((function(e,t){return e+Number((.015*t.billAmount/30*(u()(u()(t.receivedDate).format("DD.MM.YYYY"),"DD.MM.YYYY").diff(u()(u()(t.orderDate).format("DD.MM.YYYY"),"DD.MM.YYYY"),"days")-t.netDays)).toFixed(2))}),0);return p.fromDataAsync(e).then((function(e){return e.sheets().forEach((function(e){e.usedRange().style({fontFamily:"Arial",border:!0}),e.column("A").width(15),e.column("B").width(15),e.column("C").width(15),e.column("D").width(15),e.column("E").width(15),e.column("G").width(15),e.column("H").width(20),e.cell(t.totalInt).value(n.toFixed(2)),e.range(t.titleRange).merged(!0).style({bold:!0,horizontalAlignment:"center",verticalAlignment:"center",fill:"808080"}),t.tbodyRange&&e.range(t.tbodyRange).style({horizontalAlignment:"center"}),e.range(t.partyName).merged(!0).style({bold:!0,horizontalAlignment:"left"}),e.range(t.brokerName).merged(!0).style({bold:!0,horizontalAlignment:"right"}).value(T[0].bname),e.range(t.address).merged(!0).style({bold:!0,horizontalAlignment:"left"}),e.range(t.theadRange).style({fill:"808080",bold:!0,horizontalAlignment:"center"}),e.range(t.total).style({bold:!0})})),e.outputAsync().then((function(e){return URL.createObjectURL(e)}))}))};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"row",children:[(0,D.jsx)("div",{className:"mb-12 col-sm-12 col-md-2",children:(0,D.jsxs)("div",{className:"mb-3",style:{display:"flex",flexDirection:"column"},children:[(0,D.jsx)(i.L8,{htmlFor:"exampleFormControlTextarea1",children:"Bill to"}),(0,D.jsxs)(i.LX,{"aria-label":"Default select example",name:"company",value:A,onChange:w,children:[(0,D.jsx)("option",{value:"",disabled:!0,children:"Company Name"}),Array.from(new Set(g.map((function(e){return e.cname})))).map((function(e){return(0,D.jsx)("option",{value:e,children:e})}))]})]})}),(0,D.jsx)("div",{className:"mb-12 col-sm-12 col-md-2",children:(0,D.jsxs)("div",{className:"mb-3",style:{display:"flex",flexDirection:"column"},children:[(0,D.jsx)(i.L8,{htmlFor:"exampleFormControlTextarea1",children:"Bill to"}),(0,D.jsxs)(i.LX,{"aria-label":"Default select example",name:"party",value:v,onChange:w,children:[(0,D.jsx)("option",{value:"",disabled:!0,children:"Party Name"}),Array.from(new Set(g.map((function(e){return e.pname})))).map((function(e){return(0,D.jsx)("option",{value:e,children:e})}))]})]})}),(0,D.jsx)("div",{className:"mb-12 col-sm-12 col-md-2",children:(0,D.jsxs)("div",{className:"mb-3",style:{display:"flex",flexDirection:"column"},children:[(0,D.jsx)(i.L8,{htmlFor:"exampleFormControlTextarea1",children:"Bill to"}),(0,D.jsxs)(i.LX,{"aria-label":"Default select example",name:"broker",value:M,onChange:w,children:[(0,D.jsx)("option",{value:"",disabled:!0,children:"Broker Name"}),Array.from(new Set(g.map((function(e){return e.bname})))).map((function(e){return(0,D.jsx)("option",{value:e,children:e})}))]})]})}),(0,D.jsx)("div",{className:"mb-12 col-sm-12 col-md-2",children:(0,D.jsx)("div",{className:"mb-3 pt-1",style:{display:"flex",flexDirection:"column"},children:(0,D.jsx)(i.u5,{color:"success",style:{float:"right",marginTop:"27px"},onClick:function(e){d((0,l.Z)((0,l.Z)({},n),{},{company:"",party:"",broker:""})),(0,f.UQ)((function(e){C(e.data),d({optionArr:e.data})}))(N)},children:"Clear filter"})})})]}),(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"end"},children:[(0,D.jsx)(i.u5,{color:"success",className:"px-4",style:{marginBottom:"25px",marginRight:"10px"},onClick:function(){R().then((function(e){console.log(e);var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","student_report.xlsx"),t.click(),t.remove()}))},children:"Preview PDF"}),(0,D.jsx)(i.u5,{color:"primary",className:"px-4",style:{marginBottom:"25px",marginRight:"10px"},onClick:function(){j("/addBill")},children:"Add New"})]}),(0,D.jsx)("div",{style:{overflowX:"auto"},children:(0,D.jsxs)(i.Sx,{striped:!0,style:{background:"white"},children:[(0,D.jsx)(i.V,{children:(0,D.jsxs)(i.T6,{children:[(0,D.jsx)(i.is,{scope:"col",children:"Bill Date"}),(0,D.jsx)(i.is,{scope:"col",children:"Bill No"}),(0,D.jsx)(i.is,{scope:"col",children:"Bill Amount"}),(0,D.jsx)(i.is,{scope:"col",children:"Received Date"}),(0,D.jsx)(i.is,{scope:"col",children:"Total Days"}),(0,D.jsx)(i.is,{scope:"col",children:"Net Days"}),(0,D.jsx)(i.is,{scope:"col",children:"Interest Days"}),(0,D.jsx)(i.is,{scope:"col",children:"Interest Amount"}),(0,D.jsx)(i.is,{scope:"col",children:"Action"})]})}),(0,D.jsx)(i.NR,{children:0!=T.length?T.map((function(e){return(0,D.jsxs)(i.T6,{children:[(0,D.jsx)(i.NN,{children:u()(e.orderDate).format("DD/MM/YYYY")}),(0,D.jsx)(i.NN,{children:e.billNo}),(0,D.jsx)(i.NN,{children:e.billAmount}),(0,D.jsx)(i.NN,{children:u()(e.receivedDate).format("DD/MM/YYYY")}),(0,D.jsx)(i.NN,{children:u()(u()(e.receivedDate).format("DD.MM.YYYY"),"DD.MM.YYYY").diff(u()(u()(e.orderDate).format("DD.MM.YYYY"),"DD.MM.YYYY"),"days")}),(0,D.jsx)(i.NN,{children:e.netDays}),(0,D.jsx)(i.NN,{children:u()(u()(e.receivedDate).format("DD.MM.YYYY"),"DD.MM.YYYY").diff(u()(u()(e.orderDate).format("DD.MM.YYYY"),"DD.MM.YYYY"),"days")-e.netDays}),(0,D.jsx)(i.NN,{children:(.015*e.billAmount/30*(u()(u()(e.receivedDate).format("DD.MM.YYYY"),"DD.MM.YYYY").diff(u()(u()(e.orderDate).format("DD.MM.YYYY"),"DD.MM.YYYY"),"days")-e.netDays)).toFixed(2)}),(0,D.jsxs)(i.NN,{children:[(0,D.jsx)(i.u5,{color:"success",style:{marginRight:"6px",marginBottom:"3px"},onClick:function(){return function(e,t){j("/addBill/".concat(e),{state:t})}(e._id,e)},children:"Edit"}),(0,D.jsx)(i.u5,{color:"danger",style:{marginRight:"6px"},onClick:function(){return t=e._id,void(0,f.ep)(t,(function(e){h.Am.error("Deleted Successfuly!!!",{position:h.Am.POSITION.TOP_RIGHT}),(0,f.UQ)((function(e){C(e.data)}))(N)}))(N);var t},children:"Delete"})]})]})})):(0,D.jsx)(i.T6,{children:(0,D.jsx)(i.NN,{colSpan:9,style:{textAlign:"center"},children:"No items found"})})})]})}),(0,D.jsx)(h.Ix,{position:h.Am.POSITION.TOP_RIGHT,autoClose:5e3})]})}}}]);
//# sourceMappingURL=875.a283da3c.chunk.js.map